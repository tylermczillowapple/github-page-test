<!DOCTYPE html>
<html>
  <head>
    <script>
      let a = false;
      let b = false;
      function manualChangeColor() {
        document.getElementById("test").style.backgroundColor = a ? 'green' : 'purple';
        a = !a;
      };
      // document.domain = "example.com";
      window.onmessage = function(e) {
          document.getElementById("data").innerHTML = e.data;

          // if (e.origin !== "http://example.com") {
          //     return;
          // }
          // var payload = JSON.parse(e.data);
          // switch(payload.method) {
          //     case 'set':
          //         localStorage.setItem(payload.key, JSON.stringify(payload.data));
          //         break;
          //     case 'get':
          //         var parent = window.parent;
          //         var data = localStorage.getItem(payload.key);
          //         parent.postMessage(data, "*");
          //         break;
          //     case 'remove':
          //         localStorage.removeItem(payload.key);
          //         break;
          // }
      };



      function startColorChanges() {
        window.setTimeout(() => {
          document.getElementById("test2").style.backgroundColor = b ? 'red' : 'orange';
          b = !b;
          startColorChanges();
        }, 2000)
      }
    </script>
  </head>
  <body onload="startColorChanges();">
    <div id="test2" style="height: 64px;width: 64px;background-color: red;"></div>
    <div id="test" style="height: 64px;width: 64px;background-color: green;"></div>
    <p id="data">Empty</p>
    <button onClick="manualChangeColor()">Click Me!</button>
  </body>
</html>
